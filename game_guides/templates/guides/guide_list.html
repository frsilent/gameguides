{% extends 'base.html' %}
{% load embed_video_tags %}
{% load endless %}
{% load staticfiles %}

{% block page_title %}Guides Page{% endblock page_title %}
{% block ng_app %}ng-app="guides.list"{% endblock %}
{% block title %}Game Guides - Guides{% endblock title %}

{% block content %}
    <div class="row" id="top5-pane">
        <div class="sample-video-container">
            {% for guide in top5 %}
                {% video guide.video as vid %}
                <div class="col-xs-6 col-md-4 {% if forloop.first %}first-video{% endif %}">
                    <a class="thumbnail sample-video" href="{% url 'guide-detail' guide.id %}">
                        <img src="{{ vid.thumbnail }}">
                    </a>
                </div>
                {% endvideo %}
            {% endfor %}
        </div>
    </div>

    <div class="row" id="filter-pane" ng-controller="{% block ng_controller %}GuideListController{% endblock %}">
        <div class="filter-list">
        {% for category in categories %}
            <input type="checkbox" ng-click="toggleCategory({{ category.id }})">
            {{ category.name }}
        {% endfor %}
        </div>
        {% verbatim %}
        <h2>{{ currentPage+1 }} / {{ Math.ceil((guides|filter:category_filter).length / pageSize) }}</h2>

        <button ng-disabled="currentPage == 0" ng-click="currentPage=currentPage-1">Previous</button>
        <ul>
            <li ng-repeat="guide in guides | filter: category_filter |
                           paginate:currentPage * pageSize | limitTo:pageSize">{{ guide.name }}</li>
        </ul>
        <button ng-disabled="currentPage >= (guides|filter:category_filter).length / pageSize - 1" ng-click="currentPage=currentPage+1">Next</button>
        {% endverbatim %}
    </div>
{% endblock content %}

{% block extra_js %}
    {{ block.super }}
    <script src="{% static 'js/guide-list.js' %}"></script>
{% endblock %}
